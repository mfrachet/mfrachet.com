---
title: Qualitative analytics and heatmaps
date: 2024-10-04
---

import { Image } from "astro:assets";

import heatmap from "../../../assets/qualitative-analytics-and-heatmaps/hotjar.png";
import hotzone from "../../../assets/qualitative-analytics-and-heatmaps/hot-zones.png";

Analytics encompasses various forms and the collection of diverse data types.

- **Product analytics**: they aim to measure the success of a product by analyzing user behavior and product usage.
- **Web analytics**: they aim to measure the success of a website by analyzing user website usage (think of Google Analytics, Plausible, etc). They are about numbers.
- **A lot of others**: sales analytics, marketing analytics, etc.

What's fascinating about analytics is that they're always a bit biased.

**Product analytics**, for example, can only tell you about the people that are using the product the way you expected them to. Generally, you create events on specific actions that you have decided are relevant. However, you don't know about other actions: and maybe people are interacting differently than you thought.

**Web analytics** only focus on the numbers and often miss the bigger picture. Sure, you might see a million visitors on your homepage, but those numbers don't tell you if people are interacting with the content in the way you intended. It's a bit like knowing how many guests came to a party without knowing if they had a good time!

The common factor here is that they lack an element: they don't capture **how people really interact with your website or product**. Maybe your hero CTAs generates less "clicks" than the small contact button at the bottom of the page (this is a gross example, but you get the point)?

## Introducing Qualitative Analytics

Qualitative analytics is about understanding **how** people interact with your website or product. What element are they interacting with? Is it the one you expected? How to re-focus their attention where you want them to?

## ⚠️ Disclaimer

Gathering qualitative data is very intrusive. You have to (and [this is a legal requirement in Europe](https://gdpr-info.eu/)) to inform people that you are about to track them in a very extensive way.

## Representing qualitative data

Before understanding how to implement a solution to gather the qualitative data, let's try to find solution to represent the data in a meaningful way.

### Heatmaps

Heatmaps are a visual representation of zones that are active. The more the color is closed to red, the more the zone is active. The following is an image (taken from Hotjar) that shows a heatmap of a web page.

<Image src={heatmap} alt="A heatmap taken from Hotjar " />

You can represent a heatmap using a JS library called [visual-heatmap](https://github.com/nswamy14/visual-heatmap). It will show the different zones with different colors depending the data count.

You can also create something yourself using a [clustering algorithm](https://www.freecodecamp.org/news/8-clustering-algorithms-in-machine-learning-that-all-data-scientists-should-know/). It's a way to split the screen into different zones and count the number of clicks on each zone. The granularity depends on your needs. It generally not too hard to implement and avoid using an external library.

### Per element infobubble

Another approach that I find even more meaningful and interesting is to attach an infobubble to the element that is clicked (or that triggers an event that you are interested in).

It offers clear insights into the engagement on a specific element, making it simple to visually compare different elements. Additionally, you get both textual and colored information.

<div className="border border-zinc-800 rounded-xl px-8">
  <Image src={hotzone} alt="A per element infobubble on a given element " />
</div>

## Implementing a solution

In this section, I will not show you how to use XYZ product (there are plenty if you [google it](https://www.google.com/search?q=web+heatmap+analytics+sdk)).

Instead, I will show you how you can implement a solution, uncovering the core mechanisms that you can then extend to your needs and learn from.

### What do we assume

We assume that there is an operational backend and a database capable of receiving analytics events in a specific format. The key field for our purposes is the `selector` field, which indicates the element that has been interacted with.

### What do we need to do?

- A JS library that shows the heatmap/infobubble on the page.
- A JS library that tracks user interactions and that loads the heatmap/infobubble script on the page when needed (we'll see why and how)

#### A JS library that shows the heatmap/infobubble on the page

The tradeoff I'm okay to make while creating this lib is: it's okay if it's "big".

_Why it's not so important?_

This script (which displays the infobubble) will only be loaded on the webpage under very specific conditions: indeed, it's the analytics script (the one sending the events) that will append it to the DOM when they see a very specific URL.

A larger bundle size is helpful because it enables me to initiate a complete application (such as in React or Vue), simplifying the library creation process.

##### How to get the bubbles?

To get the bubbles, we need to fetch the data from the backend. We admit the backend is ready and allows us to do so. Here's the backend API:

- GET `/api/analytics/bubbles` requiring an `Authorization` header with a valid token
- The response is an `Array<{selector: string, count: number}>`

"Hold on, I've developed a custom analytics platform, and the script is meant to load on an application that I don't manage. How can I obtain the authorization header?""

Yes, you're right.

In general, when someone uses a third party service that provides heatmaps, in the dashboard the person will find a link that will redirect them to their application - with an extra parameter in the URL.

This extra parameters is a "short living token". It can be used for a small period of time to fetch the bubbles. It's generally attached to the URL via a hash fragment instead of a query parameter.

Why?

When a webpage is loaded with a hash fragment, the browser does not send the hash value to the server. It's a small detail, but it's a security feature.
